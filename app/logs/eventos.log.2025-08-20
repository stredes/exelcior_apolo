2025-08-20 00:20:11,285 - INFO - Inicializando base de datos...
2025-08-20 00:20:11,286 - INFO - Tablas creadas o verificadas correctamente.
2025-08-20 00:20:11,287 - INFO - â„¹ï¸ Validator OK (bool) desde default:/home/stredes/workspace/exelcior_apolo/app/config/excel_printer_default.json; se mantiene cfg original.
2025-08-20 00:20:11,287 - INFO - ðŸ“ User config inicializado desde default: /home/stredes/.exelcior_apolo/config.json
2025-08-20 00:20:11,288 - INFO - [CONFIG] default=/home/stredes/workspace/exelcior_apolo/app/config/excel_printer_default.json + user=/home/stredes/.exelcior_apolo/config.json -> aplicado
2025-08-20 00:22:54,247 - INFO - Inicializando base de datos...
2025-08-20 00:22:54,249 - INFO - Tablas creadas o verificadas correctamente.
2025-08-20 00:22:54,249 - INFO - â„¹ï¸ Validator OK (bool) desde default:/home/stredes/workspace/exelcior_apolo/app/config/excel_printer_default.json; se mantiene cfg original.
2025-08-20 00:22:54,249 - INFO - [CONFIG] default=/home/stredes/workspace/exelcior_apolo/app/config/excel_printer_default.json + user=/home/stredes/.exelcior_apolo/config.json -> aplicado
2025-08-20 00:23:55,223 - INFO - [CONFIG] Reglas efectivas para 'listados': {'start_row': 0, 'eliminar': ['Vendedor', 'Total', 'NÂº', 'Moneda', 'Tipo cambio', 'Tipo doc', 'RUT', 'Glosa'], 'sumar': [], 'mantener_formato': [], 'formato_texto': [], 'vista_previa_fuente': 10}
2025-08-20 00:23:55,243 - INFO - Archivo cargado: /home/stredes/Downloads/lista_doc_venta_20250326_164354.xlsx
2025-08-20 00:23:55,243 - INFO - Transformando datos para modo: listados
2025-08-20 00:23:55,243 - INFO - [XFORM] excel_processor activo: /home/stredes/workspace/exelcior_apolo/app/core/excel_processor.py
2025-08-20 00:23:55,244 - INFO - [CONFIG] Reglas efectivas para 'listados': {'start_row': 0, 'eliminar': ['Vendedor', 'Total', 'NÂº', 'Moneda', 'Tipo cambio', 'Tipo doc', 'RUT', 'Glosa'], 'sumar': [], 'mantener_formato': [], 'formato_texto': [], 'vista_previa_fuente': 10}
2025-08-20 00:23:55,244 - INFO - [XFORM] Reglas efectivas listados: {'start_row': 0, 'eliminar': ['Vendedor', 'Total', 'NÂº', 'Moneda', 'Tipo cambio', 'Tipo doc', 'RUT', 'Glosa'], 'sumar': [], 'mantener_formato': [], 'formato_texto': [], 'vista_previa_fuente': 10}
2025-08-20 00:23:55,244 - INFO - [XFORM] Match columnas -> ['Vendedor', 'Total', 'NÂº', 'Moneda', 'Tipo cambio', 'Tipo doc', 'RUT', 'Glosa'] => ['Vendedor', 'Total', 'NÂº', 'Moneda', 'Tipo cambio', 'Tipo doc', 'RUT', 'Glosa']
2025-08-20 00:23:55,247 - INFO - Columnas eliminadas: ['Vendedor', 'Total', 'NÂº', 'Moneda', 'Tipo cambio', 'Tipo doc', 'RUT', 'Glosa']
2025-08-20 00:23:55,247 - INFO - Columnas convertidas a texto: []
2025-08-20 00:23:55,262 - INFO - Historial de archivo guardado: n/a
2025-08-20 00:24:01,253 - INFO - Archivo temporal Excel generado: /tmp/tmpwfkalx4b.xlsx
2025-08-20 00:24:01,253 - INFO - ðŸ“„ Archivo temporal generado para impresiÃ³n Listado General: /tmp/tmpwfkalx4b.xlsx
2025-08-20 00:24:01,254 - INFO - [Linux] Intentando LibreOffice: libreoffice --headless --pt Default /tmp/tmpwfkalx4b.xlsx
2025-08-20 00:24:02,431 - INFO - [Linux] Enviado a impresora (LibreOffice): tmpwfkalx4b.xlsx
2025-08-20 00:24:02,431 - INFO - âœ… ImpresiÃ³n de listado general completada correctamente.
2025-08-20 00:24:02,435 - INFO - ImpresiÃ³n registrada: listados_impresion.xlsx
2025-08-20 00:24:14,744 - INFO - [CONFIG] Reglas efectivas para 'fedex': {'start_row': 0, 'eliminar': ['returnTrackingId', 'senderAccountNumber', 'recipientState', 'quoteId', 'creationDate', 'departmentNumber', 'totalShipmentWeight', 'recipientPhoneExtension', 'poNumber', 'paymentType', 'recipientEmail', 'etdEnabled', 'senderResidential', 'packageWeight', 'senderCompany', 'recipientResidential', 'recipientTin', 'recipientCountry', 'recipientLine1', 'height', 'estimatedShippingCosts', 'length', 'recipientContactNumber', 'senderCountry', 'returnRmaNumber', 'senderLine1', 'width', 'senderPhoneExtension', 'errors', 'senderLine3', 'senderState', 'senderTin', 'invoiceNumber', 'senderLine2', 'senderEmail', 'senderContactName', 'senderCity', 'pickupId', 'shipmentType', 'returnReason', 'senderPostcode', 'status', 'senderContactNumber', 'weightUnits', 'recipientLine2', 'recipientPostcode'], 'sumar': ['numberOfPackages', 'masterTrackingNumber'], 'mantener_formato': ['masterTrackingNumber'], 'formato_texto': [], 'vista_previa_fuente': 10}
2025-08-20 00:24:14,755 - INFO - Archivo cargado: /home/stredes/Downloads/Shipment_Report_2025-03-26.xlsx
2025-08-20 00:24:14,755 - INFO - Transformando datos para modo: fedex
2025-08-20 00:24:14,755 - INFO - [XFORM] excel_processor activo: /home/stredes/workspace/exelcior_apolo/app/core/excel_processor.py
2025-08-20 00:24:14,755 - INFO - [CONFIG] Reglas efectivas para 'fedex': {'start_row': 0, 'eliminar': ['returnTrackingId', 'senderAccountNumber', 'recipientState', 'quoteId', 'creationDate', 'departmentNumber', 'totalShipmentWeight', 'recipientPhoneExtension', 'poNumber', 'paymentType', 'recipientEmail', 'etdEnabled', 'senderResidential', 'packageWeight', 'senderCompany', 'recipientResidential', 'recipientTin', 'recipientCountry', 'recipientLine1', 'height', 'estimatedShippingCosts', 'length', 'recipientContactNumber', 'senderCountry', 'returnRmaNumber', 'senderLine1', 'width', 'senderPhoneExtension', 'errors', 'senderLine3', 'senderState', 'senderTin', 'invoiceNumber', 'senderLine2', 'senderEmail', 'senderContactName', 'senderCity', 'pickupId', 'shipmentType', 'returnReason', 'senderPostcode', 'status', 'senderContactNumber', 'weightUnits', 'recipientLine2', 'recipientPostcode'], 'sumar': ['numberOfPackages', 'masterTrackingNumber'], 'mantener_formato': ['masterTrackingNumber'], 'formato_texto': [], 'vista_previa_fuente': 10}
2025-08-20 00:24:14,755 - INFO - [XFORM] Reglas efectivas fedex: {'start_row': 0, 'eliminar': ['returnTrackingId', 'senderAccountNumber', 'recipientState', 'quoteId', 'creationDate', 'departmentNumber', 'totalShipmentWeight', 'recipientPhoneExtension', 'poNumber', 'paymentType', 'recipientEmail', 'etdEnabled', 'senderResidential', 'packageWeight', 'senderCompany', 'recipientResidential', 'recipientTin', 'recipientCountry', 'recipientLine1', 'height', 'estimatedShippingCosts', 'length', 'recipientContactNumber', 'senderCountry', 'returnRmaNumber', 'senderLine1', 'width', 'senderPhoneExtension', 'errors', 'senderLine3', 'senderState', 'senderTin', 'invoiceNumber', 'senderLine2', 'senderEmail', 'senderContactName', 'senderCity', 'pickupId', 'shipmentType', 'returnReason', 'senderPostcode', 'status', 'senderContactNumber', 'weightUnits', 'recipientLine2', 'recipientPostcode'], 'sumar': ['numberOfPackages', 'masterTrackingNumber'], 'mantener_formato': ['masterTrackingNumber'], 'formato_texto': [], 'vista_previa_fuente': 10}
2025-08-20 00:24:14,755 - INFO - [XFORM] Match columnas -> ['returnTrackingId', 'senderAccountNumber', 'recipientState', 'quoteId', 'creationDate', 'departmentNumber', 'totalShipmentWeight', 'recipientPhoneExtension', 'poNumber', 'paymentType', 'recipientEmail', 'etdEnabled', 'senderResidential', 'packageWeight', 'senderCompany', 'recipientResidential', 'recipientTin', 'recipientCountry', 'recipientLine1', 'height', 'estimatedShippingCosts', 'length', 'recipientContactNumber', 'senderCountry', 'returnRmaNumber', 'senderLine1', 'width', 'senderPhoneExtension', 'errors', 'senderLine3', 'senderState', 'senderTin', 'invoiceNumber', 'senderLine2', 'senderEmail', 'senderContactName', 'senderCity', 'pickupId', 'shipmentType', 'returnReason', 'senderPostcode', 'status', 'senderContactNumber', 'weightUnits', 'recipientLine2', 'recipientPostcode'] => ['returnTrackingId', 'senderAccountNumber', 'recipientState', 'quoteId', 'creationDate', 'departmentNumber', 'totalShipmentWeight', 'recipientPhoneExtension', 'poNumber', 'paymentType', 'recipientEmail', 'etdEnabled', 'senderResidential', 'packageWeight', 'senderCompany', 'recipientResidential', 'recipientTin', 'recipientCountry', 'recipientLine1', 'height', 'estimatedShippingCosts', 'length', 'recipientContactNumber', 'senderCountry', 'returnRmaNumber', 'senderLine1', 'width', 'senderPhoneExtension', 'errors', 'senderLine3', 'senderState', 'senderTin', 'invoiceNumber', 'senderLine2', 'senderEmail', 'senderContactName', 'senderCity', 'pickupId', 'shipmentType', 'returnReason', 'senderPostcode', 'status', 'senderContactNumber', 'weightUnits', 'recipientLine2', 'recipientPostcode']
2025-08-20 00:24:14,756 - INFO - [XFORM] Match columnas -> ['numberOfPackages', 'masterTrackingNumber'] => ['numberOfPackages', 'masterTrackingNumber']
2025-08-20 00:24:14,756 - INFO - [XFORM] Match columnas -> ['masterTrackingNumber'] => ['masterTrackingNumber']
2025-08-20 00:24:14,756 - INFO - Columnas eliminadas: ['returnTrackingId', 'senderAccountNumber', 'recipientState', 'quoteId', 'creationDate', 'departmentNumber', 'totalShipmentWeight', 'recipientPhoneExtension', 'poNumber', 'paymentType', 'recipientEmail', 'etdEnabled', 'senderResidential', 'packageWeight', 'senderCompany', 'recipientResidential', 'recipientTin', 'recipientCountry', 'recipientLine1', 'height', 'estimatedShippingCosts', 'length', 'recipientContactNumber', 'senderCountry', 'returnRmaNumber', 'senderLine1', 'width', 'senderPhoneExtension', 'errors', 'senderLine3', 'senderState', 'senderTin', 'invoiceNumber', 'senderLine2', 'senderEmail', 'senderContactName', 'senderCity', 'pickupId', 'shipmentType', 'returnReason', 'senderPostcode', 'status', 'senderContactNumber', 'weightUnits', 'recipientLine2', 'recipientPostcode']
2025-08-20 00:24:14,758 - INFO - [XFORM] Fila de sumatoria creada: {'numberOfPackages': np.float64(7.0), 'masterTrackingNumber': np.int64(6160570937427)}
2025-08-20 00:24:14,758 - INFO - Columnas convertidas a texto: ['masterTrackingNumber']
2025-08-20 00:24:14,761 - INFO - Historial de archivo guardado: n/a
2025-08-20 00:24:23,025 - ERROR - âŒ Error al imprimir listado FedEx: agregar_nombre_firma() missing 1 required positional argument: 'fila_inicio'
2025-08-20 00:24:23,025 - ERROR - Error al imprimir: Error en impresiÃ³n FedEx: agregar_nombre_firma() missing 1 required positional argument: 'fila_inicio'
2025-08-20 00:24:31,319 - INFO - [CONFIG] Reglas efectivas para 'urbano': {'start_row': 2, 'eliminar': ['AGENCIA', 'SHIPPER', 'FECHA CHK', 'DIAS', 'ESTADO', 'SERVICIO', 'PESO'], 'sumar': ['PIEZAS'], 'mantener_formato': [], 'formato_texto': [], 'vista_previa_fuente': 10}
2025-08-20 00:24:31,325 - INFO - Archivo cargado: /home/stredes/Downloads/211823030.xlsx
2025-08-20 00:24:31,326 - INFO - Transformando datos para modo: urbano
2025-08-20 00:24:31,326 - INFO - [XFORM] excel_processor activo: /home/stredes/workspace/exelcior_apolo/app/core/excel_processor.py
2025-08-20 00:24:31,326 - INFO - [CONFIG] Reglas efectivas para 'urbano': {'start_row': 2, 'eliminar': ['AGENCIA', 'SHIPPER', 'FECHA CHK', 'DIAS', 'ESTADO', 'SERVICIO', 'PESO'], 'sumar': ['PIEZAS'], 'mantener_formato': [], 'formato_texto': [], 'vista_previa_fuente': 10}
2025-08-20 00:24:31,326 - INFO - [XFORM] Reglas efectivas urbano: {'start_row': 2, 'eliminar': ['AGENCIA', 'SHIPPER', 'FECHA CHK', 'DIAS', 'ESTADO', 'SERVICIO', 'PESO'], 'sumar': ['PIEZAS'], 'mantener_formato': [], 'formato_texto': [], 'vista_previa_fuente': 10}
2025-08-20 00:24:31,326 - INFO - [XFORM] Match columnas -> ['AGENCIA', 'SHIPPER', 'FECHA CHK', 'DIAS', 'ESTADO', 'SERVICIO', 'PESO'] => ['AGENCIA', 'SHIPPER', 'FECHA CHK', 'DIAS', 'ESTADO', 'SERVICIO', 'PESO']
2025-08-20 00:24:31,326 - INFO - [XFORM] Match columnas -> ['PIEZAS'] => ['PIEZAS']
2025-08-20 00:24:31,326 - INFO - Columnas eliminadas: ['AGENCIA', 'SHIPPER', 'FECHA CHK', 'DIAS', 'ESTADO', 'SERVICIO', 'PESO']
2025-08-20 00:24:31,327 - INFO - [XFORM] Fila de sumatoria creada: {'PIEZAS': np.int64(33)}
2025-08-20 00:24:31,327 - INFO - Columnas convertidas a texto: []
2025-08-20 00:24:31,330 - INFO - Historial de archivo guardado: n/a
2025-08-20 00:24:34,618 - ERROR - âŒ Error al imprimir listado Urbano: agregar_nombre_firma() missing 1 required positional argument: 'fila_inicio'
2025-08-20 00:24:34,618 - ERROR - Error al imprimir: Error en impresiÃ³n Urbano: agregar_nombre_firma() missing 1 required positional argument: 'fila_inicio'
2025-08-20 00:34:56,111 - INFO - Inicializando base de datos...
2025-08-20 00:34:56,112 - INFO - Tablas creadas o verificadas correctamente.
2025-08-20 00:34:56,113 - INFO - â„¹ï¸ Validator OK (bool) desde default:/home/stredes/workspace/exelcior_apolo/app/config/excel_printer_default.json; se mantiene cfg original.
2025-08-20 00:34:56,113 - INFO - [CONFIG] default=/home/stredes/workspace/exelcior_apolo/app/config/excel_printer_default.json + user=/home/stredes/.exelcior_apolo/config.json -> aplicado
2025-08-20 00:35:01,706 - INFO - Iniciando procesamiento: /home/stredes/Downloads/lista_doc_venta_20250326_164354.xlsx
2025-08-20 00:35:01,706 - INFO - [CONFIG] Reglas efectivas para 'listados': {'start_row': 0, 'eliminar': ['Vendedor', 'Total', 'NÂº', 'Moneda', 'Tipo cambio', 'Tipo doc', 'RUT', 'Glosa'], 'sumar': [], 'mantener_formato': [], 'formato_texto': [], 'vista_previa_fuente': 10}
2025-08-20 00:35:01,719 - INFO - Archivo cargado: /home/stredes/Downloads/lista_doc_venta_20250326_164354.xlsx
2025-08-20 00:35:01,720 - INFO - Transformando datos para modo: listados
2025-08-20 00:35:01,720 - INFO - [XFORM] excel_processor activo: /home/stredes/workspace/exelcior_apolo/app/core/excel_processor.py
2025-08-20 00:35:01,720 - INFO - [CONFIG] Reglas efectivas para 'listados': {'start_row': 0, 'eliminar': ['Vendedor', 'Total', 'NÂº', 'Moneda', 'Tipo cambio', 'Tipo doc', 'RUT', 'Glosa'], 'sumar': [], 'mantener_formato': [], 'formato_texto': [], 'vista_previa_fuente': 10}
2025-08-20 00:35:01,720 - INFO - [XFORM] Reglas efectivas listados: {'start_row': 0, 'eliminar': ['Vendedor', 'Total', 'NÂº', 'Moneda', 'Tipo cambio', 'Tipo doc', 'RUT', 'Glosa'], 'sumar': [], 'mantener_formato': [], 'formato_texto': [], 'vista_previa_fuente': 10}
2025-08-20 00:35:01,720 - INFO - [XFORM] Match columnas -> ['Vendedor', 'Total', 'NÂº', 'Moneda', 'Tipo cambio', 'Tipo doc', 'RUT', 'Glosa'] => ['Vendedor', 'Total', 'NÂº', 'Moneda', 'Tipo cambio', 'Tipo doc', 'RUT', 'Glosa']
2025-08-20 00:35:01,721 - INFO - Columnas eliminadas: ['Vendedor', 'Total', 'NÂº', 'Moneda', 'Tipo cambio', 'Tipo doc', 'RUT', 'Glosa']
2025-08-20 00:35:01,721 - INFO - Columnas convertidas a texto: []
2025-08-20 00:35:01,730 - INFO - Historial de archivo guardado: /home/stredes/Downloads/lista_doc_venta_20250326_164354.xlsx
2025-08-20 00:35:07,382 - INFO - Iniciando procesamiento: /home/stredes/Downloads/Shipment_Report_2025-03-26.xlsx
2025-08-20 00:35:07,382 - INFO - [CONFIG] Reglas efectivas para 'fedex': {'start_row': 0, 'eliminar': ['returnTrackingId', 'senderAccountNumber', 'recipientState', 'quoteId', 'creationDate', 'departmentNumber', 'totalShipmentWeight', 'recipientPhoneExtension', 'poNumber', 'paymentType', 'recipientEmail', 'etdEnabled', 'senderResidential', 'packageWeight', 'senderCompany', 'recipientResidential', 'recipientTin', 'recipientCountry', 'recipientLine1', 'height', 'estimatedShippingCosts', 'length', 'recipientContactNumber', 'senderCountry', 'returnRmaNumber', 'senderLine1', 'width', 'senderPhoneExtension', 'errors', 'senderLine3', 'senderState', 'senderTin', 'invoiceNumber', 'senderLine2', 'senderEmail', 'senderContactName', 'senderCity', 'pickupId', 'shipmentType', 'returnReason', 'senderPostcode', 'status', 'senderContactNumber', 'weightUnits', 'recipientLine2', 'recipientPostcode'], 'sumar': ['numberOfPackages', 'masterTrackingNumber'], 'mantener_formato': ['masterTrackingNumber'], 'formato_texto': [], 'vista_previa_fuente': 10}
2025-08-20 00:35:07,393 - INFO - Archivo cargado: /home/stredes/Downloads/Shipment_Report_2025-03-26.xlsx
2025-08-20 00:35:07,393 - INFO - Transformando datos para modo: fedex
2025-08-20 00:35:07,393 - INFO - [XFORM] excel_processor activo: /home/stredes/workspace/exelcior_apolo/app/core/excel_processor.py
2025-08-20 00:35:07,393 - INFO - [CONFIG] Reglas efectivas para 'fedex': {'start_row': 0, 'eliminar': ['returnTrackingId', 'senderAccountNumber', 'recipientState', 'quoteId', 'creationDate', 'departmentNumber', 'totalShipmentWeight', 'recipientPhoneExtension', 'poNumber', 'paymentType', 'recipientEmail', 'etdEnabled', 'senderResidential', 'packageWeight', 'senderCompany', 'recipientResidential', 'recipientTin', 'recipientCountry', 'recipientLine1', 'height', 'estimatedShippingCosts', 'length', 'recipientContactNumber', 'senderCountry', 'returnRmaNumber', 'senderLine1', 'width', 'senderPhoneExtension', 'errors', 'senderLine3', 'senderState', 'senderTin', 'invoiceNumber', 'senderLine2', 'senderEmail', 'senderContactName', 'senderCity', 'pickupId', 'shipmentType', 'returnReason', 'senderPostcode', 'status', 'senderContactNumber', 'weightUnits', 'recipientLine2', 'recipientPostcode'], 'sumar': ['numberOfPackages', 'masterTrackingNumber'], 'mantener_formato': ['masterTrackingNumber'], 'formato_texto': [], 'vista_previa_fuente': 10}
2025-08-20 00:35:07,393 - INFO - [XFORM] Reglas efectivas fedex: {'start_row': 0, 'eliminar': ['returnTrackingId', 'senderAccountNumber', 'recipientState', 'quoteId', 'creationDate', 'departmentNumber', 'totalShipmentWeight', 'recipientPhoneExtension', 'poNumber', 'paymentType', 'recipientEmail', 'etdEnabled', 'senderResidential', 'packageWeight', 'senderCompany', 'recipientResidential', 'recipientTin', 'recipientCountry', 'recipientLine1', 'height', 'estimatedShippingCosts', 'length', 'recipientContactNumber', 'senderCountry', 'returnRmaNumber', 'senderLine1', 'width', 'senderPhoneExtension', 'errors', 'senderLine3', 'senderState', 'senderTin', 'invoiceNumber', 'senderLine2', 'senderEmail', 'senderContactName', 'senderCity', 'pickupId', 'shipmentType', 'returnReason', 'senderPostcode', 'status', 'senderContactNumber', 'weightUnits', 'recipientLine2', 'recipientPostcode'], 'sumar': ['numberOfPackages', 'masterTrackingNumber'], 'mantener_formato': ['masterTrackingNumber'], 'formato_texto': [], 'vista_previa_fuente': 10}
2025-08-20 00:35:07,394 - INFO - [XFORM] Match columnas -> ['returnTrackingId', 'senderAccountNumber', 'recipientState', 'quoteId', 'creationDate', 'departmentNumber', 'totalShipmentWeight', 'recipientPhoneExtension', 'poNumber', 'paymentType', 'recipientEmail', 'etdEnabled', 'senderResidential', 'packageWeight', 'senderCompany', 'recipientResidential', 'recipientTin', 'recipientCountry', 'recipientLine1', 'height', 'estimatedShippingCosts', 'length', 'recipientContactNumber', 'senderCountry', 'returnRmaNumber', 'senderLine1', 'width', 'senderPhoneExtension', 'errors', 'senderLine3', 'senderState', 'senderTin', 'invoiceNumber', 'senderLine2', 'senderEmail', 'senderContactName', 'senderCity', 'pickupId', 'shipmentType', 'returnReason', 'senderPostcode', 'status', 'senderContactNumber', 'weightUnits', 'recipientLine2', 'recipientPostcode'] => ['returnTrackingId', 'senderAccountNumber', 'recipientState', 'quoteId', 'creationDate', 'departmentNumber', 'totalShipmentWeight', 'recipientPhoneExtension', 'poNumber', 'paymentType', 'recipientEmail', 'etdEnabled', 'senderResidential', 'packageWeight', 'senderCompany', 'recipientResidential', 'recipientTin', 'recipientCountry', 'recipientLine1', 'height', 'estimatedShippingCosts', 'length', 'recipientContactNumber', 'senderCountry', 'returnRmaNumber', 'senderLine1', 'width', 'senderPhoneExtension', 'errors', 'senderLine3', 'senderState', 'senderTin', 'invoiceNumber', 'senderLine2', 'senderEmail', 'senderContactName', 'senderCity', 'pickupId', 'shipmentType', 'returnReason', 'senderPostcode', 'status', 'senderContactNumber', 'weightUnits', 'recipientLine2', 'recipientPostcode']
2025-08-20 00:35:07,394 - INFO - [XFORM] Match columnas -> ['numberOfPackages', 'masterTrackingNumber'] => ['numberOfPackages', 'masterTrackingNumber']
2025-08-20 00:35:07,394 - INFO - [XFORM] Match columnas -> ['masterTrackingNumber'] => ['masterTrackingNumber']
2025-08-20 00:35:07,394 - INFO - Columnas eliminadas: ['returnTrackingId', 'senderAccountNumber', 'recipientState', 'quoteId', 'creationDate', 'departmentNumber', 'totalShipmentWeight', 'recipientPhoneExtension', 'poNumber', 'paymentType', 'recipientEmail', 'etdEnabled', 'senderResidential', 'packageWeight', 'senderCompany', 'recipientResidential', 'recipientTin', 'recipientCountry', 'recipientLine1', 'height', 'estimatedShippingCosts', 'length', 'recipientContactNumber', 'senderCountry', 'returnRmaNumber', 'senderLine1', 'width', 'senderPhoneExtension', 'errors', 'senderLine3', 'senderState', 'senderTin', 'invoiceNumber', 'senderLine2', 'senderEmail', 'senderContactName', 'senderCity', 'pickupId', 'shipmentType', 'returnReason', 'senderPostcode', 'status', 'senderContactNumber', 'weightUnits', 'recipientLine2', 'recipientPostcode']
2025-08-20 00:35:07,396 - INFO - [XFORM] Fila de sumatoria creada: {'numberOfPackages': np.float64(7.0), 'masterTrackingNumber': np.int64(6160570937427)}
2025-08-20 00:35:07,397 - INFO - Columnas convertidas a texto: ['masterTrackingNumber']
2025-08-20 00:35:07,399 - INFO - Historial de archivo guardado: /home/stredes/Downloads/Shipment_Report_2025-03-26.xlsx
2025-08-20 00:35:08,744 - INFO - [CONFIG] Reglas efectivas para 'fedex': {'start_row': 0, 'eliminar': ['returnTrackingId', 'senderAccountNumber', 'recipientState', 'quoteId', 'creationDate', 'departmentNumber', 'totalShipmentWeight', 'recipientPhoneExtension', 'poNumber', 'paymentType', 'recipientEmail', 'etdEnabled', 'senderResidential', 'packageWeight', 'senderCompany', 'recipientResidential', 'recipientTin', 'recipientCountry', 'recipientLine1', 'height', 'estimatedShippingCosts', 'length', 'recipientContactNumber', 'senderCountry', 'returnRmaNumber', 'senderLine1', 'width', 'senderPhoneExtension', 'errors', 'senderLine3', 'senderState', 'senderTin', 'invoiceNumber', 'senderLine2', 'senderEmail', 'senderContactName', 'senderCity', 'pickupId', 'shipmentType', 'returnReason', 'senderPostcode', 'status', 'senderContactNumber', 'weightUnits', 'recipientLine2', 'recipientPostcode'], 'sumar': ['numberOfPackages', 'masterTrackingNumber'], 'mantener_formato': ['masterTrackingNumber'], 'formato_texto': [], 'vista_previa_fuente': 10}
2025-08-20 00:35:08,744 - ERROR - âŒ Error al imprimir listado FedEx: 'DataFrame' object has no attribute 'append'
2025-08-20 00:35:08,744 - ERROR - Error al imprimir: Error en impresiÃ³n FedEx: 'DataFrame' object has no attribute 'append'
2025-08-20 00:35:11,861 - INFO - Iniciando procesamiento: /home/stredes/Downloads/211823030.xlsx
2025-08-20 00:35:11,861 - INFO - [CONFIG] Reglas efectivas para 'urbano': {'start_row': 2, 'eliminar': ['AGENCIA', 'SHIPPER', 'FECHA CHK', 'DIAS', 'ESTADO', 'SERVICIO', 'PESO'], 'sumar': ['PIEZAS'], 'mantener_formato': [], 'formato_texto': [], 'vista_previa_fuente': 10}
2025-08-20 00:35:11,869 - INFO - Archivo cargado: /home/stredes/Downloads/211823030.xlsx
2025-08-20 00:35:11,869 - INFO - Transformando datos para modo: urbano
2025-08-20 00:35:11,869 - INFO - [XFORM] excel_processor activo: /home/stredes/workspace/exelcior_apolo/app/core/excel_processor.py
2025-08-20 00:35:11,869 - INFO - [CONFIG] Reglas efectivas para 'urbano': {'start_row': 2, 'eliminar': ['AGENCIA', 'SHIPPER', 'FECHA CHK', 'DIAS', 'ESTADO', 'SERVICIO', 'PESO'], 'sumar': ['PIEZAS'], 'mantener_formato': [], 'formato_texto': [], 'vista_previa_fuente': 10}
2025-08-20 00:35:11,869 - INFO - [XFORM] Reglas efectivas urbano: {'start_row': 2, 'eliminar': ['AGENCIA', 'SHIPPER', 'FECHA CHK', 'DIAS', 'ESTADO', 'SERVICIO', 'PESO'], 'sumar': ['PIEZAS'], 'mantener_formato': [], 'formato_texto': [], 'vista_previa_fuente': 10}
2025-08-20 00:35:11,869 - INFO - [XFORM] Match columnas -> ['AGENCIA', 'SHIPPER', 'FECHA CHK', 'DIAS', 'ESTADO', 'SERVICIO', 'PESO'] => ['AGENCIA', 'SHIPPER', 'FECHA CHK', 'DIAS', 'ESTADO', 'SERVICIO', 'PESO']
2025-08-20 00:35:11,869 - INFO - [XFORM] Match columnas -> ['PIEZAS'] => ['PIEZAS']
2025-08-20 00:35:11,870 - INFO - Columnas eliminadas: ['AGENCIA', 'SHIPPER', 'FECHA CHK', 'DIAS', 'ESTADO', 'SERVICIO', 'PESO']
2025-08-20 00:35:11,871 - INFO - [XFORM] Fila de sumatoria creada: {'PIEZAS': np.int64(33)}
2025-08-20 00:35:11,871 - INFO - Columnas convertidas a texto: []
2025-08-20 00:35:11,874 - INFO - Historial de archivo guardado: /home/stredes/Downloads/211823030.xlsx
2025-08-20 00:35:13,004 - INFO - [CONFIG] Reglas efectivas para 'urbano': {'start_row': 2, 'eliminar': ['AGENCIA', 'SHIPPER', 'FECHA CHK', 'DIAS', 'ESTADO', 'SERVICIO', 'PESO'], 'sumar': ['PIEZAS'], 'mantener_formato': [], 'formato_texto': [], 'vista_previa_fuente': 10}
2025-08-20 00:35:13,004 - ERROR - âŒ Error al imprimir listado Urbano: 'DataFrame' object has no attribute 'append'
2025-08-20 00:35:13,004 - ERROR - Error al imprimir: Error en impresiÃ³n Urbano: 'DataFrame' object has no attribute 'append'
2025-08-20 00:40:24,567 - INFO - Inicializando base de datos...
2025-08-20 00:40:24,568 - INFO - Tablas creadas o verificadas correctamente.
2025-08-20 00:40:24,569 - INFO - â„¹ï¸ Validator OK (bool) desde default:/home/stredes/workspace/exelcior_apolo/app/config/excel_printer_default.json; se mantiene cfg original.
2025-08-20 00:40:24,569 - INFO - [CONFIG] default=/home/stredes/workspace/exelcior_apolo/app/config/excel_printer_default.json + user=/home/stredes/.exelcior_apolo/config.json -> aplicado
2025-08-20 00:40:28,583 - INFO - Iniciando procesamiento: /home/stredes/Downloads/lista_doc_venta_20250326_164354.xlsx
2025-08-20 00:40:28,583 - INFO - [CONFIG] Reglas efectivas para 'listados': {'start_row': 0, 'eliminar': ['Vendedor', 'Total', 'NÂº', 'Moneda', 'Tipo cambio', 'Tipo doc', 'RUT', 'Glosa'], 'sumar': [], 'mantener_formato': [], 'formato_texto': [], 'vista_previa_fuente': 10}
2025-08-20 00:40:28,597 - INFO - Archivo cargado: /home/stredes/Downloads/lista_doc_venta_20250326_164354.xlsx
2025-08-20 00:40:28,598 - INFO - Transformando datos para modo: listados
2025-08-20 00:40:28,598 - INFO - [XFORM] excel_processor activo: /home/stredes/workspace/exelcior_apolo/app/core/excel_processor.py
2025-08-20 00:40:28,598 - INFO - [CONFIG] Reglas efectivas para 'listados': {'start_row': 0, 'eliminar': ['Vendedor', 'Total', 'NÂº', 'Moneda', 'Tipo cambio', 'Tipo doc', 'RUT', 'Glosa'], 'sumar': [], 'mantener_formato': [], 'formato_texto': [], 'vista_previa_fuente': 10}
2025-08-20 00:40:28,598 - INFO - [XFORM] Reglas efectivas listados: {'start_row': 0, 'eliminar': ['Vendedor', 'Total', 'NÂº', 'Moneda', 'Tipo cambio', 'Tipo doc', 'RUT', 'Glosa'], 'sumar': [], 'mantener_formato': [], 'formato_texto': [], 'vista_previa_fuente': 10}
2025-08-20 00:40:28,598 - INFO - [XFORM] Match columnas -> ['Vendedor', 'Total', 'NÂº', 'Moneda', 'Tipo cambio', 'Tipo doc', 'RUT', 'Glosa'] => ['Vendedor', 'Total', 'NÂº', 'Moneda', 'Tipo cambio', 'Tipo doc', 'RUT', 'Glosa']
2025-08-20 00:40:28,599 - INFO - Columnas eliminadas: ['Vendedor', 'Total', 'NÂº', 'Moneda', 'Tipo cambio', 'Tipo doc', 'RUT', 'Glosa']
2025-08-20 00:40:28,599 - INFO - Columnas convertidas a texto: []
2025-08-20 00:40:28,609 - INFO - Historial de archivo guardado: /home/stredes/Downloads/lista_doc_venta_20250326_164354.xlsx
2025-08-20 00:40:37,344 - INFO - Iniciando procesamiento: /home/stredes/Downloads/Shipment_Report_2025-03-26.xlsx
2025-08-20 00:40:37,344 - INFO - [CONFIG] Reglas efectivas para 'fedex': {'start_row': 0, 'eliminar': ['returnTrackingId', 'senderAccountNumber', 'recipientState', 'quoteId', 'creationDate', 'departmentNumber', 'totalShipmentWeight', 'recipientPhoneExtension', 'poNumber', 'paymentType', 'recipientEmail', 'etdEnabled', 'senderResidential', 'packageWeight', 'senderCompany', 'recipientResidential', 'recipientTin', 'recipientCountry', 'recipientLine1', 'height', 'estimatedShippingCosts', 'length', 'recipientContactNumber', 'senderCountry', 'returnRmaNumber', 'senderLine1', 'width', 'senderPhoneExtension', 'errors', 'senderLine3', 'senderState', 'senderTin', 'invoiceNumber', 'senderLine2', 'senderEmail', 'senderContactName', 'senderCity', 'pickupId', 'shipmentType', 'returnReason', 'senderPostcode', 'status', 'senderContactNumber', 'weightUnits', 'recipientLine2', 'recipientPostcode'], 'sumar': ['numberOfPackages', 'masterTrackingNumber'], 'mantener_formato': ['masterTrackingNumber'], 'formato_texto': [], 'vista_previa_fuente': 10}
2025-08-20 00:40:37,354 - INFO - Archivo cargado: /home/stredes/Downloads/Shipment_Report_2025-03-26.xlsx
2025-08-20 00:40:37,354 - INFO - Transformando datos para modo: fedex
2025-08-20 00:40:37,354 - INFO - [XFORM] excel_processor activo: /home/stredes/workspace/exelcior_apolo/app/core/excel_processor.py
2025-08-20 00:40:37,354 - INFO - [CONFIG] Reglas efectivas para 'fedex': {'start_row': 0, 'eliminar': ['returnTrackingId', 'senderAccountNumber', 'recipientState', 'quoteId', 'creationDate', 'departmentNumber', 'totalShipmentWeight', 'recipientPhoneExtension', 'poNumber', 'paymentType', 'recipientEmail', 'etdEnabled', 'senderResidential', 'packageWeight', 'senderCompany', 'recipientResidential', 'recipientTin', 'recipientCountry', 'recipientLine1', 'height', 'estimatedShippingCosts', 'length', 'recipientContactNumber', 'senderCountry', 'returnRmaNumber', 'senderLine1', 'width', 'senderPhoneExtension', 'errors', 'senderLine3', 'senderState', 'senderTin', 'invoiceNumber', 'senderLine2', 'senderEmail', 'senderContactName', 'senderCity', 'pickupId', 'shipmentType', 'returnReason', 'senderPostcode', 'status', 'senderContactNumber', 'weightUnits', 'recipientLine2', 'recipientPostcode'], 'sumar': ['numberOfPackages', 'masterTrackingNumber'], 'mantener_formato': ['masterTrackingNumber'], 'formato_texto': [], 'vista_previa_fuente': 10}
2025-08-20 00:40:37,354 - INFO - [XFORM] Reglas efectivas fedex: {'start_row': 0, 'eliminar': ['returnTrackingId', 'senderAccountNumber', 'recipientState', 'quoteId', 'creationDate', 'departmentNumber', 'totalShipmentWeight', 'recipientPhoneExtension', 'poNumber', 'paymentType', 'recipientEmail', 'etdEnabled', 'senderResidential', 'packageWeight', 'senderCompany', 'recipientResidential', 'recipientTin', 'recipientCountry', 'recipientLine1', 'height', 'estimatedShippingCosts', 'length', 'recipientContactNumber', 'senderCountry', 'returnRmaNumber', 'senderLine1', 'width', 'senderPhoneExtension', 'errors', 'senderLine3', 'senderState', 'senderTin', 'invoiceNumber', 'senderLine2', 'senderEmail', 'senderContactName', 'senderCity', 'pickupId', 'shipmentType', 'returnReason', 'senderPostcode', 'status', 'senderContactNumber', 'weightUnits', 'recipientLine2', 'recipientPostcode'], 'sumar': ['numberOfPackages', 'masterTrackingNumber'], 'mantener_formato': ['masterTrackingNumber'], 'formato_texto': [], 'vista_previa_fuente': 10}
2025-08-20 00:40:37,354 - INFO - [XFORM] Match columnas -> ['returnTrackingId', 'senderAccountNumber', 'recipientState', 'quoteId', 'creationDate', 'departmentNumber', 'totalShipmentWeight', 'recipientPhoneExtension', 'poNumber', 'paymentType', 'recipientEmail', 'etdEnabled', 'senderResidential', 'packageWeight', 'senderCompany', 'recipientResidential', 'recipientTin', 'recipientCountry', 'recipientLine1', 'height', 'estimatedShippingCosts', 'length', 'recipientContactNumber', 'senderCountry', 'returnRmaNumber', 'senderLine1', 'width', 'senderPhoneExtension', 'errors', 'senderLine3', 'senderState', 'senderTin', 'invoiceNumber', 'senderLine2', 'senderEmail', 'senderContactName', 'senderCity', 'pickupId', 'shipmentType', 'returnReason', 'senderPostcode', 'status', 'senderContactNumber', 'weightUnits', 'recipientLine2', 'recipientPostcode'] => ['returnTrackingId', 'senderAccountNumber', 'recipientState', 'quoteId', 'creationDate', 'departmentNumber', 'totalShipmentWeight', 'recipientPhoneExtension', 'poNumber', 'paymentType', 'recipientEmail', 'etdEnabled', 'senderResidential', 'packageWeight', 'senderCompany', 'recipientResidential', 'recipientTin', 'recipientCountry', 'recipientLine1', 'height', 'estimatedShippingCosts', 'length', 'recipientContactNumber', 'senderCountry', 'returnRmaNumber', 'senderLine1', 'width', 'senderPhoneExtension', 'errors', 'senderLine3', 'senderState', 'senderTin', 'invoiceNumber', 'senderLine2', 'senderEmail', 'senderContactName', 'senderCity', 'pickupId', 'shipmentType', 'returnReason', 'senderPostcode', 'status', 'senderContactNumber', 'weightUnits', 'recipientLine2', 'recipientPostcode']
2025-08-20 00:40:37,354 - INFO - [XFORM] Match columnas -> ['numberOfPackages', 'masterTrackingNumber'] => ['numberOfPackages', 'masterTrackingNumber']
2025-08-20 00:40:37,354 - INFO - [XFORM] Match columnas -> ['masterTrackingNumber'] => ['masterTrackingNumber']
2025-08-20 00:40:37,355 - INFO - Columnas eliminadas: ['returnTrackingId', 'senderAccountNumber', 'recipientState', 'quoteId', 'creationDate', 'departmentNumber', 'totalShipmentWeight', 'recipientPhoneExtension', 'poNumber', 'paymentType', 'recipientEmail', 'etdEnabled', 'senderResidential', 'packageWeight', 'senderCompany', 'recipientResidential', 'recipientTin', 'recipientCountry', 'recipientLine1', 'height', 'estimatedShippingCosts', 'length', 'recipientContactNumber', 'senderCountry', 'returnRmaNumber', 'senderLine1', 'width', 'senderPhoneExtension', 'errors', 'senderLine3', 'senderState', 'senderTin', 'invoiceNumber', 'senderLine2', 'senderEmail', 'senderContactName', 'senderCity', 'pickupId', 'shipmentType', 'returnReason', 'senderPostcode', 'status', 'senderContactNumber', 'weightUnits', 'recipientLine2', 'recipientPostcode']
2025-08-20 00:40:37,357 - INFO - [XFORM] Fila de sumatoria creada: {'numberOfPackages': np.float64(7.0), 'masterTrackingNumber': np.int64(6160570937427)}
2025-08-20 00:40:37,358 - INFO - Columnas convertidas a texto: ['masterTrackingNumber']
2025-08-20 00:40:37,361 - INFO - Historial de archivo guardado: /home/stredes/Downloads/Shipment_Report_2025-03-26.xlsx
2025-08-20 00:40:39,470 - INFO - [CONFIG] Reglas efectivas para 'fedex': {'start_row': 0, 'eliminar': ['returnTrackingId', 'senderAccountNumber', 'recipientState', 'quoteId', 'creationDate', 'departmentNumber', 'totalShipmentWeight', 'recipientPhoneExtension', 'poNumber', 'paymentType', 'recipientEmail', 'etdEnabled', 'senderResidential', 'packageWeight', 'senderCompany', 'recipientResidential', 'recipientTin', 'recipientCountry', 'recipientLine1', 'height', 'estimatedShippingCosts', 'length', 'recipientContactNumber', 'senderCountry', 'returnRmaNumber', 'senderLine1', 'width', 'senderPhoneExtension', 'errors', 'senderLine3', 'senderState', 'senderTin', 'invoiceNumber', 'senderLine2', 'senderEmail', 'senderContactName', 'senderCity', 'pickupId', 'shipmentType', 'returnReason', 'senderPostcode', 'status', 'senderContactNumber', 'weightUnits', 'recipientLine2', 'recipientPostcode'], 'sumar': ['numberOfPackages', 'masterTrackingNumber'], 'mantener_formato': ['masterTrackingNumber'], 'formato_texto': [], 'vista_previa_fuente': 10}
2025-08-20 00:40:39,482 - INFO - Archivo temporal Excel generado: /tmp/tmp4s59vll6.xlsx
2025-08-20 00:40:39,482 - INFO - ðŸ“„ Archivo temporal generado para impresiÃ³n FedEx: /tmp/tmp4s59vll6.xlsx
2025-08-20 00:40:39,483 - INFO - [Linux] Intentando LibreOffice: libreoffice --headless --pt Default /tmp/tmp4s59vll6.xlsx
2025-08-20 00:40:40,426 - INFO - [Linux] Enviado a impresora (LibreOffice): tmp4s59vll6.xlsx
2025-08-20 00:40:40,426 - INFO - âœ… ImpresiÃ³n de listado FedEx completada correctamente.
2025-08-20 00:40:40,429 - INFO - ImpresiÃ³n registrada: fedex_impresion.xlsx
2025-08-20 00:40:42,747 - INFO - Iniciando procesamiento: /home/stredes/Downloads/Shipment_Report_2025-03-26.xlsx
2025-08-20 00:40:42,747 - INFO - [CONFIG] Reglas efectivas para 'fedex': {'start_row': 0, 'eliminar': ['returnTrackingId', 'senderAccountNumber', 'recipientState', 'quoteId', 'creationDate', 'departmentNumber', 'totalShipmentWeight', 'recipientPhoneExtension', 'poNumber', 'paymentType', 'recipientEmail', 'etdEnabled', 'senderResidential', 'packageWeight', 'senderCompany', 'recipientResidential', 'recipientTin', 'recipientCountry', 'recipientLine1', 'height', 'estimatedShippingCosts', 'length', 'recipientContactNumber', 'senderCountry', 'returnRmaNumber', 'senderLine1', 'width', 'senderPhoneExtension', 'errors', 'senderLine3', 'senderState', 'senderTin', 'invoiceNumber', 'senderLine2', 'senderEmail', 'senderContactName', 'senderCity', 'pickupId', 'shipmentType', 'returnReason', 'senderPostcode', 'status', 'senderContactNumber', 'weightUnits', 'recipientLine2', 'recipientPostcode'], 'sumar': ['numberOfPackages', 'masterTrackingNumber'], 'mantener_formato': ['masterTrackingNumber'], 'formato_texto': [], 'vista_previa_fuente': 10}
2025-08-20 00:40:42,757 - INFO - Archivo cargado: /home/stredes/Downloads/Shipment_Report_2025-03-26.xlsx
2025-08-20 00:40:42,757 - INFO - Transformando datos para modo: fedex
2025-08-20 00:40:42,757 - INFO - [XFORM] excel_processor activo: /home/stredes/workspace/exelcior_apolo/app/core/excel_processor.py
2025-08-20 00:40:42,757 - INFO - [CONFIG] Reglas efectivas para 'fedex': {'start_row': 0, 'eliminar': ['returnTrackingId', 'senderAccountNumber', 'recipientState', 'quoteId', 'creationDate', 'departmentNumber', 'totalShipmentWeight', 'recipientPhoneExtension', 'poNumber', 'paymentType', 'recipientEmail', 'etdEnabled', 'senderResidential', 'packageWeight', 'senderCompany', 'recipientResidential', 'recipientTin', 'recipientCountry', 'recipientLine1', 'height', 'estimatedShippingCosts', 'length', 'recipientContactNumber', 'senderCountry', 'returnRmaNumber', 'senderLine1', 'width', 'senderPhoneExtension', 'errors', 'senderLine3', 'senderState', 'senderTin', 'invoiceNumber', 'senderLine2', 'senderEmail', 'senderContactName', 'senderCity', 'pickupId', 'shipmentType', 'returnReason', 'senderPostcode', 'status', 'senderContactNumber', 'weightUnits', 'recipientLine2', 'recipientPostcode'], 'sumar': ['numberOfPackages', 'masterTrackingNumber'], 'mantener_formato': ['masterTrackingNumber'], 'formato_texto': [], 'vista_previa_fuente': 10}
2025-08-20 00:40:42,757 - INFO - [XFORM] Reglas efectivas fedex: {'start_row': 0, 'eliminar': ['returnTrackingId', 'senderAccountNumber', 'recipientState', 'quoteId', 'creationDate', 'departmentNumber', 'totalShipmentWeight', 'recipientPhoneExtension', 'poNumber', 'paymentType', 'recipientEmail', 'etdEnabled', 'senderResidential', 'packageWeight', 'senderCompany', 'recipientResidential', 'recipientTin', 'recipientCountry', 'recipientLine1', 'height', 'estimatedShippingCosts', 'length', 'recipientContactNumber', 'senderCountry', 'returnRmaNumber', 'senderLine1', 'width', 'senderPhoneExtension', 'errors', 'senderLine3', 'senderState', 'senderTin', 'invoiceNumber', 'senderLine2', 'senderEmail', 'senderContactName', 'senderCity', 'pickupId', 'shipmentType', 'returnReason', 'senderPostcode', 'status', 'senderContactNumber', 'weightUnits', 'recipientLine2', 'recipientPostcode'], 'sumar': ['numberOfPackages', 'masterTrackingNumber'], 'mantener_formato': ['masterTrackingNumber'], 'formato_texto': [], 'vista_previa_fuente': 10}
2025-08-20 00:40:42,758 - INFO - [XFORM] Match columnas -> ['returnTrackingId', 'senderAccountNumber', 'recipientState', 'quoteId', 'creationDate', 'departmentNumber', 'totalShipmentWeight', 'recipientPhoneExtension', 'poNumber', 'paymentType', 'recipientEmail', 'etdEnabled', 'senderResidential', 'packageWeight', 'senderCompany', 'recipientResidential', 'recipientTin', 'recipientCountry', 'recipientLine1', 'height', 'estimatedShippingCosts', 'length', 'recipientContactNumber', 'senderCountry', 'returnRmaNumber', 'senderLine1', 'width', 'senderPhoneExtension', 'errors', 'senderLine3', 'senderState', 'senderTin', 'invoiceNumber', 'senderLine2', 'senderEmail', 'senderContactName', 'senderCity', 'pickupId', 'shipmentType', 'returnReason', 'senderPostcode', 'status', 'senderContactNumber', 'weightUnits', 'recipientLine2', 'recipientPostcode'] => ['returnTrackingId', 'senderAccountNumber', 'recipientState', 'quoteId', 'creationDate', 'departmentNumber', 'totalShipmentWeight', 'recipientPhoneExtension', 'poNumber', 'paymentType', 'recipientEmail', 'etdEnabled', 'senderResidential', 'packageWeight', 'senderCompany', 'recipientResidential', 'recipientTin', 'recipientCountry', 'recipientLine1', 'height', 'estimatedShippingCosts', 'length', 'recipientContactNumber', 'senderCountry', 'returnRmaNumber', 'senderLine1', 'width', 'senderPhoneExtension', 'errors', 'senderLine3', 'senderState', 'senderTin', 'invoiceNumber', 'senderLine2', 'senderEmail', 'senderContactName', 'senderCity', 'pickupId', 'shipmentType', 'returnReason', 'senderPostcode', 'status', 'senderContactNumber', 'weightUnits', 'recipientLine2', 'recipientPostcode']
2025-08-20 00:40:42,758 - INFO - [XFORM] Match columnas -> ['numberOfPackages', 'masterTrackingNumber'] => ['numberOfPackages', 'masterTrackingNumber']
2025-08-20 00:40:42,758 - INFO - [XFORM] Match columnas -> ['masterTrackingNumber'] => ['masterTrackingNumber']
2025-08-20 00:40:42,758 - INFO - Columnas eliminadas: ['returnTrackingId', 'senderAccountNumber', 'recipientState', 'quoteId', 'creationDate', 'departmentNumber', 'totalShipmentWeight', 'recipientPhoneExtension', 'poNumber', 'paymentType', 'recipientEmail', 'etdEnabled', 'senderResidential', 'packageWeight', 'senderCompany', 'recipientResidential', 'recipientTin', 'recipientCountry', 'recipientLine1', 'height', 'estimatedShippingCosts', 'length', 'recipientContactNumber', 'senderCountry', 'returnRmaNumber', 'senderLine1', 'width', 'senderPhoneExtension', 'errors', 'senderLine3', 'senderState', 'senderTin', 'invoiceNumber', 'senderLine2', 'senderEmail', 'senderContactName', 'senderCity', 'pickupId', 'shipmentType', 'returnReason', 'senderPostcode', 'status', 'senderContactNumber', 'weightUnits', 'recipientLine2', 'recipientPostcode']
2025-08-20 00:40:42,760 - INFO - [XFORM] Fila de sumatoria creada: {'numberOfPackages': np.float64(7.0), 'masterTrackingNumber': np.int64(6160570937427)}
2025-08-20 00:40:42,760 - INFO - Columnas convertidas a texto: ['masterTrackingNumber']
2025-08-20 00:40:42,763 - INFO - Historial de archivo guardado: /home/stredes/Downloads/Shipment_Report_2025-03-26.xlsx
2025-08-20 00:40:43,790 - INFO - [CONFIG] Reglas efectivas para 'fedex': {'start_row': 0, 'eliminar': ['returnTrackingId', 'senderAccountNumber', 'recipientState', 'quoteId', 'creationDate', 'departmentNumber', 'totalShipmentWeight', 'recipientPhoneExtension', 'poNumber', 'paymentType', 'recipientEmail', 'etdEnabled', 'senderResidential', 'packageWeight', 'senderCompany', 'recipientResidential', 'recipientTin', 'recipientCountry', 'recipientLine1', 'height', 'estimatedShippingCosts', 'length', 'recipientContactNumber', 'senderCountry', 'returnRmaNumber', 'senderLine1', 'width', 'senderPhoneExtension', 'errors', 'senderLine3', 'senderState', 'senderTin', 'invoiceNumber', 'senderLine2', 'senderEmail', 'senderContactName', 'senderCity', 'pickupId', 'shipmentType', 'returnReason', 'senderPostcode', 'status', 'senderContactNumber', 'weightUnits', 'recipientLine2', 'recipientPostcode'], 'sumar': ['numberOfPackages', 'masterTrackingNumber'], 'mantener_formato': ['masterTrackingNumber'], 'formato_texto': [], 'vista_previa_fuente': 10}
2025-08-20 00:40:43,802 - INFO - Archivo temporal Excel generado: /tmp/tmpikx2vyf8.xlsx
2025-08-20 00:40:43,802 - INFO - ðŸ“„ Archivo temporal generado para impresiÃ³n FedEx: /tmp/tmpikx2vyf8.xlsx
2025-08-20 00:40:43,802 - INFO - [Linux] Intentando LibreOffice: libreoffice --headless --pt Default /tmp/tmpikx2vyf8.xlsx
2025-08-20 00:40:44,626 - INFO - [Linux] Enviado a impresora (LibreOffice): tmpikx2vyf8.xlsx
2025-08-20 00:40:44,626 - INFO - âœ… ImpresiÃ³n de listado FedEx completada correctamente.
2025-08-20 00:40:44,629 - INFO - ImpresiÃ³n registrada: fedex_impresion.xlsx
2025-08-20 00:40:47,684 - INFO - Iniciando procesamiento: /home/stredes/Downloads/211823030.xlsx
2025-08-20 00:40:47,684 - INFO - [CONFIG] Reglas efectivas para 'urbano': {'start_row': 2, 'eliminar': ['AGENCIA', 'SHIPPER', 'FECHA CHK', 'DIAS', 'ESTADO', 'SERVICIO', 'PESO'], 'sumar': ['PIEZAS'], 'mantener_formato': [], 'formato_texto': [], 'vista_previa_fuente': 10}
2025-08-20 00:40:47,728 - INFO - Archivo cargado: /home/stredes/Downloads/211823030.xlsx
2025-08-20 00:40:47,728 - INFO - Transformando datos para modo: urbano
2025-08-20 00:40:47,728 - INFO - [XFORM] excel_processor activo: /home/stredes/workspace/exelcior_apolo/app/core/excel_processor.py
2025-08-20 00:40:47,728 - INFO - [CONFIG] Reglas efectivas para 'urbano': {'start_row': 2, 'eliminar': ['AGENCIA', 'SHIPPER', 'FECHA CHK', 'DIAS', 'ESTADO', 'SERVICIO', 'PESO'], 'sumar': ['PIEZAS'], 'mantener_formato': [], 'formato_texto': [], 'vista_previa_fuente': 10}
2025-08-20 00:40:47,728 - INFO - [XFORM] Reglas efectivas urbano: {'start_row': 2, 'eliminar': ['AGENCIA', 'SHIPPER', 'FECHA CHK', 'DIAS', 'ESTADO', 'SERVICIO', 'PESO'], 'sumar': ['PIEZAS'], 'mantener_formato': [], 'formato_texto': [], 'vista_previa_fuente': 10}
2025-08-20 00:40:47,728 - INFO - [XFORM] Match columnas -> ['AGENCIA', 'SHIPPER', 'FECHA CHK', 'DIAS', 'ESTADO', 'SERVICIO', 'PESO'] => ['AGENCIA', 'SHIPPER', 'FECHA CHK', 'DIAS', 'ESTADO', 'SERVICIO', 'PESO']
2025-08-20 00:40:47,728 - INFO - [XFORM] Match columnas -> ['PIEZAS'] => ['PIEZAS']
2025-08-20 00:40:47,729 - INFO - Columnas eliminadas: ['AGENCIA', 'SHIPPER', 'FECHA CHK', 'DIAS', 'ESTADO', 'SERVICIO', 'PESO']
2025-08-20 00:40:47,730 - INFO - [XFORM] Fila de sumatoria creada: {'PIEZAS': np.int64(33)}
2025-08-20 00:40:47,730 - INFO - Columnas convertidas a texto: []
2025-08-20 00:40:47,732 - INFO - Historial de archivo guardado: /home/stredes/Downloads/211823030.xlsx
2025-08-20 00:40:49,998 - INFO - [CONFIG] Reglas efectivas para 'urbano': {'start_row': 2, 'eliminar': ['AGENCIA', 'SHIPPER', 'FECHA CHK', 'DIAS', 'ESTADO', 'SERVICIO', 'PESO'], 'sumar': ['PIEZAS'], 'mantener_formato': [], 'formato_texto': [], 'vista_previa_fuente': 10}
2025-08-20 00:40:50,007 - INFO - Archivo temporal Excel generado: /tmp/tmplx0tu5pl.xlsx
2025-08-20 00:40:50,008 - INFO - ðŸ“„ Archivo temporal generado para impresiÃ³n Urbano: /tmp/tmplx0tu5pl.xlsx
2025-08-20 00:40:50,008 - INFO - [Linux] Intentando LibreOffice: libreoffice --headless --pt Default /tmp/tmplx0tu5pl.xlsx
2025-08-20 00:40:50,821 - INFO - [Linux] Enviado a impresora (LibreOffice): tmplx0tu5pl.xlsx
2025-08-20 00:40:50,821 - INFO - âœ… ImpresiÃ³n de listado Urbano completada correctamente.
2025-08-20 00:40:50,823 - INFO - ImpresiÃ³n registrada: urbano_impresion.xlsx
2025-08-20 01:16:23,903 - INFO - ðŸ“„ Archivo temporal generado para impresiÃ³n FedEx: /tmp/tmpua6_0e4m.xlsx
2025-08-20 01:16:23,903 - INFO - âœ… ImpresiÃ³n de listado FedEx completada correctamente.
2025-08-20 01:16:23,917 - INFO - ðŸ“„ Archivo temporal generado para impresiÃ³n Urbano: /tmp/tmprb9r92tx.xlsx
2025-08-20 01:16:23,917 - INFO - âœ… ImpresiÃ³n de listado Urbano completada correctamente.
2025-08-20 01:16:23,925 - INFO - ðŸ“„ Archivo temporal generado para impresiÃ³n Listado General: /tmp/tmp7rcv4kbi.xlsx
2025-08-20 01:16:23,931 - INFO - âœ… ImpresiÃ³n de listado general completada correctamente.
2025-08-20 01:18:57,392 - INFO - ðŸ“„ Archivo temporal generado para impresiÃ³n FedEx: /tmp/tmpc19z4zg2.xlsx
2025-08-20 01:18:57,393 - INFO - âœ… ImpresiÃ³n de listado FedEx completada correctamente.
2025-08-20 01:18:57,406 - INFO - ðŸ“„ Archivo temporal generado para impresiÃ³n Urbano: /tmp/tmpc2zdviy1.xlsx
2025-08-20 01:18:57,406 - INFO - âœ… ImpresiÃ³n de listado Urbano completada correctamente.
2025-08-20 01:18:57,414 - INFO - ðŸ“„ Archivo temporal generado para impresiÃ³n Listado General: /tmp/tmpag4b81ih.xlsx
2025-08-20 01:18:57,419 - INFO - âœ… ImpresiÃ³n de listado general completada correctamente.
2025-08-20 23:49:25,191 - INFO - Inicializando base de datos...
2025-08-20 23:49:25,192 - INFO - Tablas creadas o verificadas correctamente.
2025-08-20 23:49:25,193 - INFO - â„¹ï¸ Validator OK (bool) desde default:/home/stredes/workspace/exelcior_apolo/app/config/excel_printer_default.json; se mantiene cfg original.
2025-08-20 23:49:25,194 - INFO - [CONFIG] default=/home/stredes/workspace/exelcior_apolo/app/config/excel_printer_default.json + user=/home/stredes/.exelcior_apolo/config.json -> aplicado
2025-08-20 23:49:31,866 - INFO - Iniciando procesamiento: /home/stredes/Downloads/lista_doc_venta_20250326_164354.xlsx
2025-08-20 23:49:31,866 - INFO - [CONFIG] Reglas efectivas para 'listados': {'start_row': 0, 'eliminar': ['Vendedor', 'Total', 'NÂº', 'Moneda', 'Tipo cambio', 'Tipo doc', 'RUT', 'Glosa'], 'sumar': [], 'mantener_formato': [], 'formato_texto': [], 'vista_previa_fuente': 10}
2025-08-20 23:49:31,889 - INFO - Archivo cargado: /home/stredes/Downloads/lista_doc_venta_20250326_164354.xlsx
2025-08-20 23:49:31,889 - INFO - Transformando datos para modo: listados
2025-08-20 23:49:31,889 - INFO - [XFORM] excel_processor activo: /home/stredes/workspace/exelcior_apolo/app/core/excel_processor.py
2025-08-20 23:49:31,889 - INFO - [CONFIG] Reglas efectivas para 'listados': {'start_row': 0, 'eliminar': ['Vendedor', 'Total', 'NÂº', 'Moneda', 'Tipo cambio', 'Tipo doc', 'RUT', 'Glosa'], 'sumar': [], 'mantener_formato': [], 'formato_texto': [], 'vista_previa_fuente': 10}
2025-08-20 23:49:31,890 - INFO - [XFORM] Reglas efectivas listados: {'start_row': 0, 'eliminar': ['Vendedor', 'Total', 'NÂº', 'Moneda', 'Tipo cambio', 'Tipo doc', 'RUT', 'Glosa'], 'sumar': [], 'mantener_formato': [], 'formato_texto': [], 'vista_previa_fuente': 10}
2025-08-20 23:49:31,890 - INFO - [XFORM] Match columnas -> ['Vendedor', 'Total', 'NÂº', 'Moneda', 'Tipo cambio', 'Tipo doc', 'RUT', 'Glosa'] => ['Vendedor', 'Total', 'NÂº', 'Moneda', 'Tipo cambio', 'Tipo doc', 'RUT', 'Glosa']
2025-08-20 23:49:31,894 - INFO - Columnas eliminadas: ['Vendedor', 'Total', 'NÂº', 'Moneda', 'Tipo cambio', 'Tipo doc', 'RUT', 'Glosa']
2025-08-20 23:49:31,894 - INFO - Columnas convertidas a texto: []
2025-08-20 23:49:31,911 - INFO - Historial de archivo guardado: /home/stredes/Downloads/lista_doc_venta_20250326_164354.xlsx
2025-08-20 23:49:38,216 - INFO - Iniciando procesamiento: /home/stredes/Downloads/Shipment_Report_2025-03-26.xlsx
2025-08-20 23:49:38,217 - INFO - [CONFIG] Reglas efectivas para 'fedex': {'start_row': 0, 'eliminar': ['returnTrackingId', 'senderAccountNumber', 'recipientState', 'quoteId', 'creationDate', 'departmentNumber', 'totalShipmentWeight', 'recipientPhoneExtension', 'poNumber', 'paymentType', 'recipientEmail', 'etdEnabled', 'senderResidential', 'packageWeight', 'senderCompany', 'recipientResidential', 'recipientTin', 'recipientCountry', 'recipientLine1', 'height', 'estimatedShippingCosts', 'length', 'recipientContactNumber', 'senderCountry', 'returnRmaNumber', 'senderLine1', 'width', 'senderPhoneExtension', 'errors', 'senderLine3', 'senderState', 'senderTin', 'invoiceNumber', 'senderLine2', 'senderEmail', 'senderContactName', 'senderCity', 'pickupId', 'shipmentType', 'returnReason', 'senderPostcode', 'status', 'senderContactNumber', 'weightUnits', 'recipientLine2', 'recipientPostcode'], 'sumar': ['numberOfPackages', 'masterTrackingNumber'], 'mantener_formato': ['masterTrackingNumber'], 'formato_texto': [], 'vista_previa_fuente': 10}
2025-08-20 23:49:38,230 - INFO - Archivo cargado: /home/stredes/Downloads/Shipment_Report_2025-03-26.xlsx
2025-08-20 23:49:38,230 - INFO - Transformando datos para modo: fedex
2025-08-20 23:49:38,230 - INFO - [XFORM] excel_processor activo: /home/stredes/workspace/exelcior_apolo/app/core/excel_processor.py
2025-08-20 23:49:38,230 - INFO - [CONFIG] Reglas efectivas para 'fedex': {'start_row': 0, 'eliminar': ['returnTrackingId', 'senderAccountNumber', 'recipientState', 'quoteId', 'creationDate', 'departmentNumber', 'totalShipmentWeight', 'recipientPhoneExtension', 'poNumber', 'paymentType', 'recipientEmail', 'etdEnabled', 'senderResidential', 'packageWeight', 'senderCompany', 'recipientResidential', 'recipientTin', 'recipientCountry', 'recipientLine1', 'height', 'estimatedShippingCosts', 'length', 'recipientContactNumber', 'senderCountry', 'returnRmaNumber', 'senderLine1', 'width', 'senderPhoneExtension', 'errors', 'senderLine3', 'senderState', 'senderTin', 'invoiceNumber', 'senderLine2', 'senderEmail', 'senderContactName', 'senderCity', 'pickupId', 'shipmentType', 'returnReason', 'senderPostcode', 'status', 'senderContactNumber', 'weightUnits', 'recipientLine2', 'recipientPostcode'], 'sumar': ['numberOfPackages', 'masterTrackingNumber'], 'mantener_formato': ['masterTrackingNumber'], 'formato_texto': [], 'vista_previa_fuente': 10}
2025-08-20 23:49:38,230 - INFO - [XFORM] Reglas efectivas fedex: {'start_row': 0, 'eliminar': ['returnTrackingId', 'senderAccountNumber', 'recipientState', 'quoteId', 'creationDate', 'departmentNumber', 'totalShipmentWeight', 'recipientPhoneExtension', 'poNumber', 'paymentType', 'recipientEmail', 'etdEnabled', 'senderResidential', 'packageWeight', 'senderCompany', 'recipientResidential', 'recipientTin', 'recipientCountry', 'recipientLine1', 'height', 'estimatedShippingCosts', 'length', 'recipientContactNumber', 'senderCountry', 'returnRmaNumber', 'senderLine1', 'width', 'senderPhoneExtension', 'errors', 'senderLine3', 'senderState', 'senderTin', 'invoiceNumber', 'senderLine2', 'senderEmail', 'senderContactName', 'senderCity', 'pickupId', 'shipmentType', 'returnReason', 'senderPostcode', 'status', 'senderContactNumber', 'weightUnits', 'recipientLine2', 'recipientPostcode'], 'sumar': ['numberOfPackages', 'masterTrackingNumber'], 'mantener_formato': ['masterTrackingNumber'], 'formato_texto': [], 'vista_previa_fuente': 10}
2025-08-20 23:49:38,231 - INFO - [XFORM] Match columnas -> ['returnTrackingId', 'senderAccountNumber', 'recipientState', 'quoteId', 'creationDate', 'departmentNumber', 'totalShipmentWeight', 'recipientPhoneExtension', 'poNumber', 'paymentType', 'recipientEmail', 'etdEnabled', 'senderResidential', 'packageWeight', 'senderCompany', 'recipientResidential', 'recipientTin', 'recipientCountry', 'recipientLine1', 'height', 'estimatedShippingCosts', 'length', 'recipientContactNumber', 'senderCountry', 'returnRmaNumber', 'senderLine1', 'width', 'senderPhoneExtension', 'errors', 'senderLine3', 'senderState', 'senderTin', 'invoiceNumber', 'senderLine2', 'senderEmail', 'senderContactName', 'senderCity', 'pickupId', 'shipmentType', 'returnReason', 'senderPostcode', 'status', 'senderContactNumber', 'weightUnits', 'recipientLine2', 'recipientPostcode'] => ['returnTrackingId', 'senderAccountNumber', 'recipientState', 'quoteId', 'creationDate', 'departmentNumber', 'totalShipmentWeight', 'recipientPhoneExtension', 'poNumber', 'paymentType', 'recipientEmail', 'etdEnabled', 'senderResidential', 'packageWeight', 'senderCompany', 'recipientResidential', 'recipientTin', 'recipientCountry', 'recipientLine1', 'height', 'estimatedShippingCosts', 'length', 'recipientContactNumber', 'senderCountry', 'returnRmaNumber', 'senderLine1', 'width', 'senderPhoneExtension', 'errors', 'senderLine3', 'senderState', 'senderTin', 'invoiceNumber', 'senderLine2', 'senderEmail', 'senderContactName', 'senderCity', 'pickupId', 'shipmentType', 'returnReason', 'senderPostcode', 'status', 'senderContactNumber', 'weightUnits', 'recipientLine2', 'recipientPostcode']
2025-08-20 23:49:38,231 - INFO - [XFORM] Match columnas -> ['numberOfPackages', 'masterTrackingNumber'] => ['numberOfPackages', 'masterTrackingNumber']
2025-08-20 23:49:38,231 - INFO - [XFORM] Match columnas -> ['masterTrackingNumber'] => ['masterTrackingNumber']
2025-08-20 23:49:38,232 - INFO - Columnas eliminadas: ['returnTrackingId', 'senderAccountNumber', 'recipientState', 'quoteId', 'creationDate', 'departmentNumber', 'totalShipmentWeight', 'recipientPhoneExtension', 'poNumber', 'paymentType', 'recipientEmail', 'etdEnabled', 'senderResidential', 'packageWeight', 'senderCompany', 'recipientResidential', 'recipientTin', 'recipientCountry', 'recipientLine1', 'height', 'estimatedShippingCosts', 'length', 'recipientContactNumber', 'senderCountry', 'returnRmaNumber', 'senderLine1', 'width', 'senderPhoneExtension', 'errors', 'senderLine3', 'senderState', 'senderTin', 'invoiceNumber', 'senderLine2', 'senderEmail', 'senderContactName', 'senderCity', 'pickupId', 'shipmentType', 'returnReason', 'senderPostcode', 'status', 'senderContactNumber', 'weightUnits', 'recipientLine2', 'recipientPostcode']
2025-08-20 23:49:38,235 - INFO - [XFORM] Fila de sumatoria creada: {'numberOfPackages': np.float64(7.0), 'masterTrackingNumber': np.int64(6160570937427)}
2025-08-20 23:49:38,236 - INFO - Columnas convertidas a texto: ['masterTrackingNumber']
2025-08-20 23:49:38,240 - INFO - Historial de archivo guardado: /home/stredes/Downloads/Shipment_Report_2025-03-26.xlsx
